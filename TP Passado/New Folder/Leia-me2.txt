Ou, fiz quase nada aqui
Comentei um tiquinho, não alterei nada ainda
Talvez uns opcodes, mas tá imcompleto